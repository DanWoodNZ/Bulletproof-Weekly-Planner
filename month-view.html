<!DOCTYPE html>
<html>

<head>
    <title>Glance</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
</head>
<style>
    .custom-menu {
        display: none;
        z-index: 1000;
        position: absolute;
        overflow: hidden;
        border: 1px solid #CCC;
        white-space: nowrap;
        font-family: sans-serif;
        background: #FFF;
        color: #333;
        border-radius: 5px;
        padding: 0;
    }

    /* Each of the items in the list */

    .custom-menu li {
        padding: 8px 12px;
        cursor: pointer;
        list-style-type: none;
        transition: all .3s ease;
        user-select: none;
    }

    .custom-menu li:hover {
        background-color: #DEF;
    }
</style>
<script>
    $(document).ready(function () {
        $.get("backend/getConsultantsAndClients.php", function (data) {

            var databaseResults = [],
                clients = [],
                consultants = [];

            databaseResults = JSON.parse(data); //Store consultant and client arrays recieved from server

            consultants = databaseResults[0]; //Store array of consultants

            clients = databaseResults[1]; //Store array of clients

            for (x in consultants) {
                addConsultantToMonthlyBoard(consultants[x])
            }

            addClientToMonthlyBoard(clients);
        });

        function addConsultantToMonthlyBoard(consultant) {
            var consultantHTML = "";

            consultantHTML = "<tr>";
            consultantHTML += "<td>" + consultant['name'] + "</td>";
            consultantHTML += "<td class='allocation'></td>";
            consultantHTML += "<td class='allocation'></td>";
            consultantHTML += "<td class='allocation'></td>";
            consultantHTML += "<td class='allocation'></td>";
            consultantHTML += "</tr>";

            $("#monthtablebody").append(consultantHTML);
        }

        function addClientToMonthlyBoard(clients) {
            var clientHTML = "";
            clientHTML = "<tr><td>";
            for (x in clients) {

                clientHTML += clients[x]['name'] + "<br>";

            }
            clientHTML += "</td></tr>";
            $("#clienttablebody").append(clientHTML);
        }

        // JAVASCRIPT (jQuery)

        // Trigger action when the contexmenu is about to be shown
        
        $("#monthtable").on("contextmenu",".allocation", function (event) {

            // Avoid the real one
            event.preventDefault();

            // Show contextmenu
            $(".custom-menu").finish().toggle(100).

                // In the right position (the mouse)
                css({
                    top: event.pageY + "px",
                    left: event.pageX + "px"
                });
        });


        // If the document is clicked somewhere
        $(document).bind("mousedown", function (e) {

            // If the clicked element is not the menu
            if (!$(e.target).parents(".custom-menu").length > 0) {

                // Hide it
                $(".custom-menu").hide(100);
            }
        });


        // If the menu element is clicked
        $(".custom-menu li").click(function () {

            // This is the triggered action name
            switch ($(this).attr("data-action")) {

                // A case for each action. Your actions here
                case "first": alert("first"); break;
                case "second": alert("second"); break;
                case "third": alert("third"); break;
            }

            // Hide it AFTER the action was triggered
            $(".custom-menu").hide(100);
        });



    });
</script>

<body>
    <ul class='custom-menu'>
        <li data-action="1">On-Site</li>
        <li data-action="2">Office Time</li>
        <li data-action="0">N/A</li>
    </ul>
    <table id="monthtable" class="table table-bordered">
        <thead id="monthtablehead">
            <tr id="monthtableheadrow">
                <th>Consultants</th>
                <th>This Week </th>
                <th>Week 2 </th>
                <th>Week 3 </th>
                <th>Week 4 </th>
            </tr>
        </thead>
        <tbody id="monthtablebody">
        </tbody>
    </table>
    <table id="clienttable" class="table table-bordered">
        <thead id="clienttablehead">
            <tr id="clienttableheadrow">
                <th>Client</th>
            </tr>
        </thead>
        <tbody id="clienttablebody">
        </tbody>
    </table>
</body>

</html>